{"version":3,"file":"commonHelpers.js","sources":["../src/js/api.js","../src/js/render-gallery.js","../src/js/index.js"],"sourcesContent":["const PIXABAY_API_KEY = '40905423-24d24966a8b04fca12252a818';\nimport axios from 'axios';\n\nexport async function fetchImages(query, pageNumber, perPage) {\n  const response = await axios.get(\n    `https://pixabay.com/api/?key=${PIXABAY_API_KEY}&q=${query}&image_type=photo&orientation=horizontal&safesearch=true&page=${pageNumber}&per_page=${perPage}`\n  );\n  return response.data;\n}\n","const galleryList = document.querySelector('.gallery');\n\nexport function renderGallery(elements) {\n  const markup = elements\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => {\n        return `\n    <li class=\"photo-card\">\n    <a href=\"${largeImageURL}\">\n      <img class=\"photo-img\" src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\">\n    </a>\n    <div class=\"info\">\n        <p class=\"info-item\">\n            <b>Likes</b>${likes}\n        </p>\n            <p class=\"info-item\">\n        <b>Views</b>${views}\n        </p>\n        <p class=\"info-item\">\n            <b>Comments</b>${comments}\n        </p>\n        <p class=\"info-item\">\n            <b>Downloads</b>${downloads}\n        </p>\n    </div>\n  </li>\n  `;\n      }\n    )\n    .join('');\n\n  galleryList.insertAdjacentHTML('beforeend', markup);\n}\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport { fetchImages } from './api';\nimport { renderGallery } from './render-gallery';\n\nconst form = document.querySelector('.search-form');\nconst galleryList = document.querySelector('.gallery');\n\nlet pageNumber = 1;\nlet query = '';\nlet simpleLightbox = new SimpleLightbox('.gallery a');\nconst perPage = 40;\nlet isLoading = false;\n\nform.addEventListener('submit', handleSearch);\nwindow.addEventListener('scroll', handleScroll);\n\nasync function handleSearch(event) {\n  event.preventDefault();\n  query = event.target.searchQuery.value.trim();\n\n  if (!query.trim()) {\n    iziToast.warning({\n      title: 'Warning',\n      message: 'Please, fill the main field',\n      position: 'topRight',\n    });\n    return;\n  }\n\n  galleryList.innerHTML = '';\n\n  try {\n    const { hits, totalHits } = await fetchImages(query, pageNumber, perPage);\n\n    if (totalHits === 0) {\n      iziToast.error({\n        title: 'Error',\n        message:\n          'Sorry, there are no images matching your search query. Please try again.',\n        maxWidth: '450px',\n        position: 'topRight',\n      });\n      return;\n    }\n    renderGallery(hits);\n    simpleLightbox.refresh();\n    iziToast.success({\n      title: 'Success',\n      message: `Hooray! We found ${totalHits} images!`,\n      position: 'topRight',\n    });\n  } catch (error) {\n    console.log(error);\n  }\n}\n\nasync function handleScroll() {\n  if (checkIfEndOfPage() && !isLoading) {\n    isLoading = true;\n    pageNumber += 1;\n\n    try {\n      const { hits, totalHits } = await fetchImages(query, pageNumber, perPage);\n      renderGallery(hits);\n      simpleLightbox.refresh();\n      const totalPages = Math.ceil(totalHits / perPage);\n\n      if (pageNumber >= totalPages) {\n        iziToast.info({\n          title: 'Info',\n          message: \"We're sorry, but you've reached the end of search results.\",\n          position: 'topRight',\n        });\n        window.removeEventListener('scroll', handleScroll);\n      }\n    } catch (error) {\n      console.log(error);\n    } finally {\n      isLoading = false;\n    }\n  }\n}\n\nfunction checkIfEndOfPage() {\n  const triggerOffset = 360;\n  return (\n    window.innerHeight + window.scrollY >=\n    document.documentElement.scrollHeight - triggerOffset\n  );\n}\n"],"names":["PIXABAY_API_KEY","fetchImages","query","pageNumber","perPage","axios","galleryList","renderGallery","elements","markup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","form","simpleLightbox","SimpleLightbox","isLoading","handleSearch","handleScroll","event","iziToast","hits","totalHits","error","checkIfEndOfPage","totalPages"],"mappings":"owBAAA,MAAMA,EAAkB,qCAGjB,eAAeC,EAAYC,EAAOC,EAAYC,EAAS,CAI5D,OAHiB,MAAMC,EAAM,IAC3B,gCAAgCL,OAAqBE,kEAAsEC,cAAuBC,GACtJ,GACkB,IAClB,CCRA,MAAME,EAAc,SAAS,cAAc,UAAU,EAE9C,SAASC,EAAcC,EAAU,CACtC,MAAMC,EAASD,EACZ,IACC,CAAC,CACC,aAAAE,EACA,cAAAC,EACA,KAAAC,EACA,MAAAC,EACA,MAAAC,EACA,SAAAC,EACA,UAAAC,CACR,IACe;AAAA;AAAA,eAEAL;AAAA,oCACqBD,WAAsBE;AAAA;AAAA;AAAA;AAAA,0BAIhCC;AAAA;AAAA;AAAA,sBAGJC;AAAA;AAAA;AAAA,6BAGOC;AAAA;AAAA;AAAA,8BAGCC;AAAA;AAAA;AAAA;AAAA,GAMzB,EACA,KAAK,EAAE,EAEVV,EAAY,mBAAmB,YAAaG,CAAM,CACpD,CChCA,MAAMQ,EAAO,SAAS,cAAc,cAAc,EAC5CX,EAAc,SAAS,cAAc,UAAU,EAErD,IAAIH,EAAa,EACbD,EAAQ,GACRgB,EAAiB,IAAIC,EAAe,YAAY,EACpD,MAAMf,EAAU,GAChB,IAAIgB,EAAY,GAEhBH,EAAK,iBAAiB,SAAUI,CAAY,EAC5C,OAAO,iBAAiB,SAAUC,CAAY,EAE9C,eAAeD,EAAaE,EAAO,CAIjC,GAHAA,EAAM,eAAc,EACpBrB,EAAQqB,EAAM,OAAO,YAAY,MAAM,KAAI,EAEvC,CAACrB,EAAM,OAAQ,CACjBsB,EAAS,QAAQ,CACf,MAAO,UACP,QAAS,8BACT,SAAU,UAChB,CAAK,EACD,MACD,CAEDlB,EAAY,UAAY,GAExB,GAAI,CACF,KAAM,CAAE,KAAAmB,EAAM,UAAAC,GAAc,MAAMzB,EAAYC,EAAOC,EAAYC,CAAO,EAExE,GAAIsB,IAAc,EAAG,CACnBF,EAAS,MAAM,CACb,MAAO,QACP,QACE,2EACF,SAAU,QACV,SAAU,UAClB,CAAO,EACD,MACD,CACDjB,EAAckB,CAAI,EAClBP,EAAe,QAAO,EACtBM,EAAS,QAAQ,CACf,MAAO,UACP,QAAS,oBAAoBE,YAC7B,SAAU,UAChB,CAAK,CACF,OAAQC,EAAP,CACA,QAAQ,IAAIA,CAAK,CAClB,CACH,CAEA,eAAeL,GAAe,CAC5B,GAAIM,EAAgB,GAAM,CAACR,EAAW,CACpCA,EAAY,GACZjB,GAAc,EAEd,GAAI,CACF,KAAM,CAAE,KAAAsB,EAAM,UAAAC,GAAc,MAAMzB,EAAYC,EAAOC,EAAYC,CAAO,EACxEG,EAAckB,CAAI,EAClBP,EAAe,QAAO,EACtB,MAAMW,EAAa,KAAK,KAAKH,EAAYtB,CAAO,EAE5CD,GAAc0B,IAChBL,EAAS,KAAK,CACZ,MAAO,OACP,QAAS,6DACT,SAAU,UACpB,CAAS,EACD,OAAO,oBAAoB,SAAUF,CAAY,EAEpD,OAAQK,EAAP,CACA,QAAQ,IAAIA,CAAK,CACvB,QAAc,CACRP,EAAY,EACb,CACF,CACH,CAEA,SAASQ,GAAmB,CAE1B,OACE,OAAO,YAAc,OAAO,SAC5B,SAAS,gBAAgB,aAAe,GAE5C"}